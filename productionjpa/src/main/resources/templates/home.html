<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>制造物联中间件系统</title>
    <style type="text/css">
        .content {
            padding: 10px 10px 10px 10px;
        }

        .divNorth {
            background-size: 100% 100%;
        }
    </style>
    <script type="text/javascript"
            th:src="@{/js/jquery-easyui-1.7.0/jquery.min.js}"
            src="/js/jquery-easyui-1.7.0/jquery.min.js"></script>
    <script type="text/javascript"
            th:src="@{/js/jquery.easyui.min.js}"
            src="/js/jquery.easyui.min.js"></script>
    <script type="text/javascript"
            th:src="@{/js/common.js}"
            src="/js/common.js"></script>
    <script type="text/javascript"
            th:src="@{/js/datagrid-filter.js}"
            src="/js/datagrid-filter.js"></script>
    <script type="text/javascript"
            th:src="@{/js/jquery-easyui-1.7.0/easyui-lang-zh_CN.js}"
            src="/js/jquery-easyui-1.7.0/easyui-lang-zh_CN.js"></script>
    <link rel="stylesheet" type="text/css"
          th:href="@{/css/easyui.css}"
          href="../../static/css/easyui.css"/>
    <link rel="stylesheet" type="text/css"
          th:href="@{/css/icon.css}"
          href="../../static/css/icon.css"/>
    <link rel="stylesheet" type="text/css"
          th:href="@{/css/taotao.css}"
          href="/css/taotao.css"/>
    <link href="/js/kindeditor-4.1.10/themes/default/default.css"
          th:href="@{/js/kindeditor-4.1.10/themes/default/default.css}"
          type="text/css" rel="stylesheet">
    <script type="text/javascript" charset="utf-8"
            th:src="@{/js/kindeditor-4.1.10/kindeditor-all-min.js}"
            src="/js/kindeditor-4.1.10/kindeditor-all-min.js"></script>
    <script type="text/javascript" charset="utf-8"
            th:src="@{/js/kindeditor-4.1.10/lang/zh_CN.js}"
            src="/js/kindeditor-4.1.10/lang/zh_CN.js"></script>
</head>
<body class="easyui-layout">

<div id="HomeFuncAccordion" class="easyui-accordion" style="width:213px;"
     data-options="region:'west',title:'功能菜单',split:false">

    <div title="功能搜索"
         data-options="iconCls:'icon-search',collapsed:false,collapsible:false"
         style="padding:10px;">
        <input id="HomeFuncSearch" class="easyui-searchbox"
               data-options={prompt:'请输入想要搜索的功能'}
               searcher="doSearch"
               style="width:178px;height:25px;">
    </div>
    <div title="计划进度" data-options="selected:true" style="padding:10px;">
        <ul id="scheduleMonitor" class="easyui-tree" data-options="animate:true,lines:true">
            <li><span>计划进度</span>
                <ul>
                    <li id=11 data-options="attributes:{'url':'/order/'}">订单管理</li>
                </ul>
                <ul>
                    <li id=12 data-options="attributes:{'url':'/custom/'}">客户管理</li>
                </ul>
                <ul>
                    <li id=13 data-options="attributes:{'url':'/product/'}">产品管理</li>
                </ul>
                <ul>
                    <li id=14 data-options="attributes:{'url':'/work/'}">作业管理</li>
                </ul>
                <ul>
                    <li id=15 data-options="attributes:{'url':'/manufacture/'}">生产计划管理</li>
                </ul>
                <ul>
                    <li id=16 data-options="attributes:{'url':'/task/'}">生产派工管理</li>
                </ul>
            </li>
        </ul>
    </div>
    <div title="设备管理" data-options="selected:true" style="padding:10px">
        <ul id="deviceMonitor" class="easyui-tree" data-options="animate:true,lines:true">
            <li><span>设备管理</span>
                <ul>
                    <li id=21 data-options="attributes:{'url':'/device/'}">设备台账</li>
                    <li id=22 data-options="attributes:{'url':'/deviceType/'}">设备种类</li>
                    <li id=23 data-options="attributes:{'url':'/deviceCheck/'}">设备例检</li>
                    <li id=24 data-options="attributes:{'url':'/deviceFault/'}">设备故障</li>
                    <!--<li id=25 data-options="attributes:{'url':'/deviceMaintain/'}">设备维修</li>-->
                </ul>
            </li>
        </ul>
    </div>

    <div title="工艺监控" data-options="selected:true" style="padding:10px">
        <ul id="technologyMonitor" class="easyui-tree" data-options="animate:true,lines:true">
            <li><span>工艺监控</span>
                <ul>
                    <li id=31 data-options="attributes:{'url':'/technology/'}">工艺管理</li>
                    <li id=32 data-options="attributes:{'url':'/technologyRequirement/'}">工艺要求</li>
                    <li id=33 data-options="attributes:{'url':'/technologyPlan/'}">工艺计划</li>
                    <li id=34 data-options="attributes:{'url':'/process/'}">工序管理</li>
                </ul>
            </li>
        </ul>
    </div>

    <div title="物料监控" data-options="selected:true" style="padding:10px">
        <ul id="materialMonitor" class="easyui-tree" data-options="animate:true,lines:true">
            <li><span>物料监控 </span>
                <ul>
                    <li id=41 data-options="attributes:{'url':'/material/'}">物料信息</li>
                    <li id=42 data-options="attributes:{'url':'/materialReceive/'}">物料收入</li>
                    <li id=43 data-options="attributes:{'url':'/materialConsume/'}">物料消耗</li>
                </ul>
            </li>
        </ul>
    </div>

    <div title="人员监控" data-options="selected:true" style="padding:10px">
        <ul id="employeeMonitor" class="easyui-tree" data-options="animate:true,lines:true">
            <li><span>人员监控</span>
                <ul>
                    <li id=61 data-options="attributes:{'url':'/department/'}">部门管理</li>
                </ul>
                <ul>
                    <li id=62 data-options="attributes:{'url':'/employee/'}">员工管理</li>
                </ul>
            </li>
        </ul>
    </div>

</div>

<div id="MainPage" data-options="region:'center',title:''">
    <div id="tabs" class="easyui-tabs">
        <div title="首页" style="padding:20px;"></div>
    </div>
</div>

<script type="text/javascript" th:inline="none">

    var allItem = [
        ["计划进度", "订单管理", "客户管理", "产品管理", "作业管理", "生产计划管理", "生产派工管理"],
        ["设备管理", "设备台账", "设备种类", "设备例检", "设备故障"],
        ["工艺监控", "工艺", "工艺要求", "工艺计划", "工序"],
        ["物料监控", "物料信息", "物料收入", "物料消耗"],
        ["人员监控", "部门管理", "员工管理"]
    ];

    function isContains(str, substr) {
        return new RegExp(substr).test(str);
    }

    function doSearch(value) {
        var subItem;
        var ifElseContain = false;
        for (var i = 0; i < allItem.length; i++) {
            for (var j = 0; j < allItem[i].length; j++) {
                subItem = allItem[i][j];
                if (isContains(subItem, value) && value != "") {
                    ifElseContain = true;
                    if (j == 0) {
                        switch (i) {
                            case 0 :
                                $('#HomeFuncAccordion').accordion('select', allItem[0][0]);
                                var node = $('#scheduleMonitor').tree('find', 11);
                                $('#scheduleMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 1 :
                                $('#HomeFuncAccordion').accordion('select', allItem[1][0]);
                                var node = $('#deviceMonitor').tree('find', 21);
                                $('#deviceMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 2 :
                                $('#HomeFuncAccordion').accordion('select', allItem[2][0]);
                                var node = $('#technologyMonitor').tree('find', 31);
                                $('#technologyMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 3 :
                                $('#HomeFuncAccordion').accordion('select', allItem[3][0]);
                                var node = $('#materialMonitor').tree('find', 41);
                                $('#materialMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 4 :
                                $('#HomeFuncAccordion').accordion('select', allItem[4][0]);
                                var node = $('#qualifyMonitor').tree('find', 51);
                                $('#qualifyMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            default:
                                break;
                        }
                    } else if (j > 0) {
                        var k = (i + 1) * 10 + j;
                        switch (i) {
                            case 0 :
                                $('#HomeFuncAccordion').accordion('select', allItem[0][0]);
                                var node = $('#scheduleMonitor').tree('find', k);
                                $('#scheduleMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 1 :
                                $('#HomeFuncAccordion').accordion('select', allItem[1][0]);
                                var node = $('#deviceMonitor').tree('find', k);
                                $('#deviceMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 2 :
                                $('#HomeFuncAccordion').accordion('select', allItem[2][0]);
                                var node = $('#technologyMonitor').tree('find', k);
                                $('#technologyMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 3 :
                                $('#HomeFuncAccordion').accordion('select', allItem[3][0]);
                                var node = $('#materialMonitor').tree('find', k);
                                $('#materialMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            case 4 :
                                $('#HomeFuncAccordion').accordion('select', allItem[4][0]);
                                var node = $('#qualifyMonitor').tree('find', k);
                                $('#qualifyMonitor').tree('expandTo', node.target).tree('select', node.target);
                                break;
                            default:
                                break;
                        }
                    }
                    break;
                }
            }
            if (ifElseContain == true) {
                break;
            }
        }
    }

    $(function () {
        $('#scheduleMonitor').tree({
            onClick: function (node) {
                if ($('#scheduleMonitor').tree("isLeaf", node.target)) {
                    var tabs1 = $("#tabs");
                    var tab1 = tabs1.tabs("getTab", node.text);
                    if (tab1) {
                        tabs1.tabs("select", node.text);
                    } else {
                        tabs1.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#deviceMonitor').tree({
            onClick: function (node) {
                if ($('#deviceMonitor').tree("isLeaf", node.target)) {
                    var tabs2 = $("#tabs");
                    var tab2 = tabs2.tabs("getTab", node.text);
                    if (tab2) {
                        tabs2.tabs("select", node.text);
                    } else {
                        tabs2.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#materialMonitor').tree({
            onClick: function (node) {
                if ($('#materialMonitor').tree("isLeaf", node.target)) {
                    var tabs2 = $("#tabs");
                    var tab2 = tabs2.tabs("getTab", node.text);
                    if (tab2) {
                        tabs2.tabs("select", node.text);
                    } else {
                        tabs2.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#qualifyMonitor').tree({
            onClick: function (node) {
                if ($('#qualifyMonitor').tree("isLeaf", node.target)) {
                    var tabs1 = $("#tabs");
                    var tab1 = tabs1.tabs("getTab", node.text);
                    if (tab1) {
                        tabs1.tabs("select", node.text);
                    } else {
                        tabs1.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#technologyMonitor').tree({
            onClick: function (node) {
                if ($('#technologyMonitor').tree("isLeaf", node.target)) {
                    var tabs3 = $("#tabs");
                    var tab3 = tabs3.tabs("getTab", node.text);
                    if (tab3) {
                        tabs3.tabs("select", node.text);
                    } else {
                        tabs3.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#employeeMonitor').tree({
            onClick: function (node) {
                /!* debugger; *!/
                if ($('#deviceMonitor').tree("isLeaf", node.target)) {
                    var tabs2 = $("#tabs");
                    var tab2 = tabs2.tabs("getTab", node.text);
                    if (tab2) {
                        tabs2.tabs("select", node.text);
                    } else {
                        tabs2.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

        $('#sysManager').tree({
            onClick: function (node) {
                if ($('#sysManager').tree("isLeaf", node.target)) {
                    var tabs3 = $("#tabs");
                    var tab3 = tabs3.tabs("getTab", node.text);
                    if (tab3) {
                        tabs3.tabs("select", node.text);
                    } else {
                        tabs3.tabs('add', {
                            title: node.text,
                            href: node.attributes.url,
                            closable: true,
                            bodyCls: "content"
                        });
                    }
                }
            }
        });

    });

</script>
</body>
</html>